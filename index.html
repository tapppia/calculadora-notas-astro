<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora de Notas con Guardado</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Oswald', sans-serif;
        background-color: white;
        color: black;
        text-align: center;
    }
    .container {
        max-width: 650px;
        margin: auto;
        padding: 20px;
    }
    h1 {
        background-color: #FFD60A;
        color: white;
        padding: 15px;
        border-radius: 10px;
        font-size: 28px;
    }
    label {
        display: block;
        margin-top: 15px;
        font-size: 18px;
        text-align: left;
    }
    input, select {
        padding: 8px;
        font-size: 16px;
        width: 100%;
        margin-top: 5px;
        border-radius: 8px;
        border: 2px solid #FFD60A;
        text-align: center;
        font-family: 'Oswald', sans-serif;
        background-color: white;
        color: black;
    }
    .yellow-select {
        background-color: #FFD60A;
        color: white;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url('data:image/svg+xml;utf8,<svg fill="white" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
    }
    .btn {
        margin-top: 15px;
        background-color: #FFD60A;
        color: white;
        border: none;
        padding: 10px;
        font-size: 16px;
        cursor: pointer;
        border-radius: 8px;
        font-family: 'Oswald', sans-serif;
        width: 100%;
    }
    .btn:hover {
        opacity: 0.85;
    }
    .results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 10px;
        background-color: #FFD60A;
        color: white;
        font-size: 18px;
    }
    .note-input {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
        gap: 10px;
    }
    .note-input input {
        width: 48%;
    }
    table {
        width: 100%;
        margin-top: 20px;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #FFD60A;
        padding: 8px;
        font-size: 14px;
    }
    th {
        background-color: #FFD60A;
        color: white;
    }
    td button {
        background-color: #FFD60A;
        color: white;
        border: none;
        padding: 5px 8px;
        cursor: pointer;
        border-radius: 5px;
        font-family: 'Oswald', sans-serif;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Calculadora de Notas</h1>

    <label for="curso">Selecciona el curso:</label>
    <select id="curso" class="yellow-select">
        <option value="">-- Selecciona un curso --</option>
        <option>Introducci√≥n a la F√≠sica I</option>
        <option>Bases Matem√°ticas para la F√≠sica I</option>
        <option>F√≠sica Computacional I</option>
        <option>Datos F√≠sicos I</option>
        <option>Gesti√≥n Personal</option>
        <option>Introducci√≥n a la Astrofisica</option>
        <option>Ingl√©s I</option>
        <option>Introducci√≥n a la F√≠sica II</option>
        <option>Bases Matem√°ticas para la F√≠sica II</option>
        <option>F√≠sica Computacional II</option>
        <option>Datos F√≠sicos II</option>
        <option>Introducci√≥n a la Ciencia de Datos</option>
        <option>Comunicaci√≥n cient√≠fica</option>
        <option>Ingl√©s II</option>
        <option>Mec√°nica Newtoniana</option>
        <option>C√°lculo Vectorial</option>
        <option>F√≠sica Computacional III</option>
        <option>Estructura de la Materia</option>
        <option>Termodinamica</option>
        <option>Desarrollo de Software</option>
        <option>Ingl√©s III</option>
        <option>Electromagnetismo</option>
        <option>Ondas</option>
        <option>M√©todos Matem√°ticos para la F√≠sica I</option>
        <option>F√≠sica Computacional IV</option>
        <option>Introducci√≥n a la Estad√≠stica Moderna</option>
        <option>Proyecto de Especialidad</option>
        <option>Ingl√©s IV</option>
        <option>Mec√°nica Cl√°sica</option>
        <option>Fen√≥menos cu√°nticos</option>
        <option>M√©todos Matem√°ticos para la F√≠sica II</option>
        <option>Astrof√≠sica Estelar</option>
        <option>Astrof√≠sica Observacional</option>
        <option>Electivo I</option>
        <option>Mecanica de Fluidos</option>
        <option>Mec√°nica Estad√≠stica</option>
        <option>Inferencia y modelos estad√≠sticos</option>
        <option>Astrof√≠sica gal√°ctica y cosmologia</option>
        <option>Estructura y bases de datos</option>
        <option>Electivo II</option>
        <option>Procesos radiativos y difusos</option>
        <option>Instrumentaci√≥n y tecnolog√≠a astron√≥mica</option>
        <option>Modelamiento en Astrof√≠sica</option>
        <option>Astrof√≠sica y Big Data</option>
        <option>Electivo III</option>
        <option>Trabajo de titulaci√≥n</option>
    </select>

    <label for="notaAprobacion">Nota m√≠nima para aprobar:</label>
    <input type="number" id="notaAprobacion" step="0.1" value="4.0" min="1.0" max="7.0">

    <label for="cantidadNotas">Cantidad de notas:</label>
    <input type="number" id="cantidadNotas" min="1" max="10" value="3">

    <button class="btn" onclick="toggleMode()">Modo: Promedio Simple</button>

    <div id="notasContainer"></div>

    <button class="btn" onclick="guardarCurso()">Guardar curso</button>

    <div class="results" id="resultados"></div>

    <h2 style="margin-top:30px;">üìö Cursos guardados</h2>
    <table id="tablaCursos">
        <tr><th>Curso</th><th>Promedio</th><th>Acciones</th></tr>
    </table>
</div>

<script>
let esPonderado = false;

function toggleMode() {
    esPonderado = !esPonderado;
    document.querySelector(".btn").textContent = esPonderado ? "Modo: Promedio Ponderado" : "Modo: Promedio Simple";
    generarCampos();
}

document.getElementById("cantidadNotas").addEventListener("input", generarCampos);
generarCampos();
cargarTabla();

function generarCampos(notas = [], pesos = []) {
    const contenedor = document.getElementById("notasContainer");
    contenedor.innerHTML = "";
    const cantidad = parseInt(document.getElementById("cantidadNotas").value);
    
    for (let i = 0; i < cantidad; i++) {
        const div = document.createElement("div");
        div.classList.add("note-input");
        
        const notaInput = document.createElement("input");
        notaInput.type = "number";
        notaInput.step = "0.1";
        notaInput.placeholder = "Nota (ej: 5.5)";
        if (notas[i] !== undefined) notaInput.value = notas[i];
        notaInput.oninput = calcular;
        div.appendChild(notaInput);

        if (esPonderado) {
            const pesoInput = document.createElement("input");
            pesoInput.type = "number";
            pesoInput.step = "0.1";
            pesoInput.placeholder = "% Peso";
            if (pesos[i] !== undefined) pesoInput.value = pesos[i];
            pesoInput.oninput = calcular;
            div.appendChild(pesoInput);
        }

        contenedor.appendChild(div);
    }
}

function calcular() {
    const notaAprobacion = parseFloat(document.getElementById("notaAprobacion").value);
    const filas = document.querySelectorAll("#notasContainer .note-input");
    let sumaPesos = 0, sumaNotas = 0, notasIngresadas = 0;
    let notasArr = [], pesosArr = [];

    filas.forEach(fila => {
        const nota = parseFloat(fila.children[0].value);
        const peso = esPonderado ? parseFloat(fila.children[1]?.value) : null;
        notasArr.push(isNaN(nota) ? null : nota);
        if (esPonderado) pesosArr.push(isNaN(peso) ? null : peso);

        if (!isNaN(nota)) {
            notasIngresadas++;
            if (esPonderado && !isNaN(peso)) {
                sumaNotas += nota * peso;
                sumaPesos += peso;
            } else if (!esPonderado) {
                sumaNotas += nota;
            }
        }
    });

    let promedio = 0;
    if (esPonderado && sumaPesos > 0) {
        promedio = sumaNotas / sumaPesos;
    } else if (!esPonderado && notasIngresadas > 0) {
        promedio = sumaNotas / notasIngresadas;
    }
    promedio = parseFloat(promedio.toFixed(1));

    let resultado = `Promedio actual: ${isNaN(promedio) ? "-" : promedio}`;
    if (!isNaN(promedio)) {
        if (promedio >= notaAprobacion) {
            resultado += `<br>Aprobado`;
        } else {
            const notasRestantes = filas.length - notasIngresadas;
            if (notasRestantes > 0) {
                const puntosNecesarios = notaAprobacion * filas.length - sumaNotas;
                const notaNecesaria = puntosNecesarios / notasRestantes;
                if (notaNecesaria > 7) {
                    resultado += `<br>Necesitas: Lo siento, ya no es posible aprobar.`;
                } else {
                    resultado += `<br>Necesitas: ${notaNecesaria.toFixed(1)} en promedio en las notas restantes.`;
                }
            } else {
                resultado += `<br>Reprobado`;
            }
        }
    }
    document.getElementById("resultados").innerHTML = resultado;
    return { promedio, notasArr, pesosArr };
}

function guardarCurso() {
    const curso = document.getElementById("curso").value;
    if (!curso) { alert("Selecciona un curso"); return; }
    const { promedio, notasArr, pesosArr } = calcular();
    if (isNaN(promedio)) { alert("Ingresa al menos una nota"); return; }
    const datos = {
        curso: curso,
        promedio: promedio,
        modo: esPonderado ? "ponderado" : "simple",
        notaAprobacion: parseFloat(document.getElementById("notaAprobacion").value),
        notas: notasArr,
        pesos: esPonderado ? pesosArr : []
    };
    let guardados = JSON.parse(localStorage.getItem("cursosGuardados")) || [];
    const index = guardados.findIndex(c => c.curso === curso);
    if (index >= 0) {
        guardados[index] = datos;
    } else {
        guardados.push(datos);
    }
    localStorage.setItem("cursosGuardados", JSON.stringify(guardados));
    cargarTabla();
}

function cargarTabla() {
    const tabla = document.getElementById("tablaCursos");
    tabla.innerHTML = `<tr><th>Curso</th><th>Promedio</th><th>Acciones</th></tr>`;
    let guardados = JSON.parse(localStorage.getItem("cursosGuardados")) || [];
    guardados.forEach(c => {
        tabla.innerHTML += `<tr>
            <td>${c.curso}</td>
            <td>${c.promedio}</td>
            <td>
                <button onclick="cargarCurso('${c.curso}')">Cargar</button>
                <button onclick="borrarCurso('${c.curso}')">Borrar</button>
            </td>
        </tr>`;
    });
}

function cargarCurso(nombre) {
    let guardados = JSON.parse(localStorage.getItem("cursosGuardados")) || [];
    const curso = guardados.find(c => c.curso === nombre);
    if (!curso) return;
    document.getElementById("curso").value = curso.curso;
    document.getElementById("notaAprobacion").value = curso.notaAprobacion;
    esPonderado = curso.modo === "ponderado";
    document.querySelector(".btn").textContent = esPonderado ? "Modo: Promedio Ponderado" : "Modo: Promedio Simple";
    document.getElementById("cantidadNotas").value = curso.notas.length;
    generarCampos(curso.notas, curso.pesos);
    calcular();
}

function borrarCurso(nombre) {
    let guardados = JSON.parse(localStorage.getItem("cursosGuardados")) || [];
    guardados = guardados.filter(c => c.curso !== nombre);
    localStorage.setItem("cursosGuardados", JSON.stringify(guardados));
    cargarTabla();
}
</script>
</body>
</html>
